<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Port Scanner - Cybersecurity Project</title>
    <style>
        /* Import professional fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');
        
        /* CSS Reset and Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* GitHub Dark Theme Colors */
        :root {
            --gh-bg: #0d1117;
            --gh-bg-secondary: #161b22;
            --gh-bg-tertiary: #21262d;
            --gh-border: #30363d;
            --gh-border-secondary: #21262d;
            --gh-text-primary: #f0f6fc;
            --gh-text-secondary: #c9d1d9;
            --gh-text-muted: #8b949e;
            --gh-accent: #58a6ff;
            --gh-accent-hover: #79c0ff;
            --gh-success: #56d364;
            --gh-warning: #d29922;
            --gh-danger: #f85149;
            --gh-code-bg: #161b22;
            --gh-code-border: #30363d;
        }
        
        /* Base Styles */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--gh-text-primary);
            background: var(--gh-bg);
            min-height: 100vh;
            padding: 16px;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.25;
            margin-bottom: 16px;
        }
        
        h1 {
            font-size: 2.25rem;
            font-weight: 700;
        }
        
        h2 {
            font-size: 1.875rem;
            border-bottom: 1px solid var(--gh-border);
            padding-bottom: 8px;
            margin-top: 48px;
            margin-bottom: 24px;
        }
        
        h3 {
            font-size: 1.5rem;
            margin-top: 32px;
            margin-bottom: 16px;
        }
        
        h4 {
            font-size: 1.25rem;
            margin-top: 24px;
            margin-bottom: 12px;
        }
        
        p {
            margin-bottom: 16px;
            color: var(--gh-text-secondary);
            line-height: 1.7;
        }
        
        /* Links */
        a {
            color: var(--gh-accent);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        a:hover {
            color: var(--gh-accent-hover);
            text-decoration: underline;
        }
        
        /* Lists */
        ul, ol {
            margin-left: 24px;
            margin-bottom: 16px;
            color: var(--gh-text-secondary);
        }
        
        li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        /* Code */
        code {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.875rem;
            background: var(--gh-code-bg);
            border: 1px solid var(--gh-code-border);
            border-radius: 6px;
            padding: 2px 6px;
            color: var(--gh-text-primary);
        }
        
        pre {
            background: var(--gh-code-bg);
            border: 1px solid var(--gh-code-border);
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 16px 0;
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.45;
        }
        
        pre code {
            background: none;
            border: none;
            padding: 0;
            border-radius: 0;
        }
        
        /* Container */
        .container {
            max-width: 1024px;
            margin: 0 auto;
            background: var(--gh-bg-secondary);
            border: 1px solid var(--gh-border);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        /* Header */
        .header {
            background: var(--gh-bg-tertiary);
            color: var(--gh-text-primary);
            padding: 48px 32px;
            text-align: center;
            border-bottom: 1px solid var(--gh-border);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 12px;
            font-weight: 700;
            line-height: 1.2;
            color: var(--gh-text-primary);
        }
        
        .header .subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            font-weight: 400;
            color: var(--gh-text-secondary);
        }
        
        /* Content */
        .content {
            padding: 48px 32px;
        }
        
        /* Project Cards */
        .project-card {
            background: var(--gh-bg-tertiary);
            border: 1px solid var(--gh-border);
            border-radius: 8px;
            padding: 24px;
            margin: 24px 0;
            transition: all 0.2s ease;
        }
        
        .project-card:hover {
            border-color: var(--gh-accent);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.1);
        }
        
        .project-card h3 {
            color: var(--gh-text-primary);
            margin-top: 0;
            margin-bottom: 12px;
        }
        
        .project-card p {
            color: var(--gh-text-secondary);
            margin-bottom: 16px;
        }
        
        .project-card ul {
            margin-left: 0;
            margin-bottom: 0;
        }
        
        .project-card li {
            color: var(--gh-text-secondary);
            font-size: 0.875rem;
        }
        
        /* Project Header */
        .project-header {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
            align-items: center;
        }
        
        .difficulty {
            font-size: 0.875rem;
            color: var(--gh-text-secondary);
            font-weight: 500;
        }
        
        .time {
            background: var(--gh-bg);
            color: var(--gh-text-secondary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid var(--gh-border);
        }
        
        .skills {
            background: var(--gh-bg);
            color: var(--gh-text-secondary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid var(--gh-border);
        }
        
        /* Special Components */
        .warning {
            background: var(--gh-bg-tertiary);
            border-left: 4px solid var(--gh-warning);
            padding: 16px;
            margin: 16px 0;
            border-radius: 6px;
        }
        
        .warning strong {
            color: var(--gh-warning);
        }
        
        .security-note {
            background: var(--gh-bg-tertiary);
            border-left: 4px solid var(--gh-accent);
            padding: 16px;
            margin: 16px 0;
            border-radius: 6px;
        }
        
        .security-note strong {
            color: var(--gh-accent);
        }
        
        .tips-box {
            background: var(--gh-bg-tertiary);
            padding: 20px;
            border: 1px solid var(--gh-border);
            border-radius: 8px;
            margin: 24px 0;
        }
        
        .pitfalls-box {
            background: var(--gh-bg-tertiary);
            padding: 20px;
            border: 1px solid var(--gh-border);
            border-radius: 8px;
            margin: 24px 0;
        }
        
        .pitfalls-box .wrong {
            color: var(--gh-danger);
            font-weight: 600;
        }
        
        .pitfalls-box .right {
            color: var(--gh-success);
            font-weight: 600;
        }
        
        .learning-path {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }
        
        .week-card {
            background: var(--gh-bg-tertiary);
            border: 1px solid var(--gh-border);
            padding: 20px;
            border-radius: 8px;
        }
        
        .week-card h4 {
            color: var(--gh-text-primary);
            margin-top: 0;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }
        
        .resource-card {
            background: var(--gh-bg-tertiary);
            padding: 20px;
            border: 1px solid var(--gh-border);
            border-radius: 8px;
        }
        
        .resource-card h4 {
            color: var(--gh-text-primary);
            margin-top: 0;
        }
        
        hr {
            border: none;
            height: 1px;
            background: var(--gh-border);
            margin: 32px 0;
        }
        
        /* Navigation */
        .nav {
            margin-bottom: 16px;
        }

        .nav a {
            color: var(--gh-text-secondary);
            font-size: 0.875rem;
            margin: 0 12px;
        }

        .nav a:hover {
            color: var(--gh-accent);
        }

        .home-link {
            position: absolute;
            top: 16px;
            left: 32px;
            font-size: 0.875rem;
            color: var(--gh-text-muted);
        }

        .home-link:hover {
            color: var(--gh-accent);
        }

        
        .footer {
            background: var(--gh-bg-tertiary);
            color: var(--gh-text-primary);
            padding: 32px;
            text-align: center;
            border-top: 1px solid var(--gh-border);
        }
        
        .footer p {
            color: var(--gh-text-secondary);
            margin: 4px 0;
            font-size: 0.875rem;
        }
        
        .tags {
            margin-top: 16px;
        }
        
        .tag {
            display: inline-block;
            background: var(--gh-bg);
            color: var(--gh-accent);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            margin: 4px;
            border: 1px solid var(--gh-border);
            transition: all 0.2s ease;
        }
        
        .tag:hover {
            background: var(--gh-accent);
            color: var(--gh-bg);
        }
        
        .takeaways {
            background: var(--gh-bg-tertiary);
            color: var(--gh-text-primary);
            padding: 20px;
            border: 1px solid var(--gh-border);
            border-radius: 8px;
            margin: 24px 0;
        }
        
        .takeaways h3 {
            color: var(--gh-text-primary);
            margin-top: 0;
        }
        
        .takeaways ul {
            color: var(--gh-text-primary);
        }
        
        .next-steps {
            background: var(--gh-bg-tertiary);
            border-left: 4px solid var(--gh-success);
            padding: 16px;
            margin: 24px 0;
            border-radius: 6px;
        }
        
        .next-steps ol {
            color: var(--gh-success);
        }
        
        /* Step Boxes */
        .step-box {
            background: var(--gh-bg-tertiary);
            border: 1px solid var(--gh-border);
            padding: 20px;
            margin: 16px 0;
            position: relative;
            border-radius: 8px;
        }
        
        .step-number {
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--gh-accent);
            color: var(--gh-bg);
            padding: 4px 8px;
            font-weight: bold;
            border-radius: 50%;
            font-size: 0.75rem;
        }
        
        .resource-link {
            color: var(--gh-accent);
            text-decoration: none;
            border-bottom: 1px dotted var(--gh-accent);
        }
        
        .resource-link:hover {
            border-bottom: 1px solid var(--gh-accent);
        }
        
        /* Emoji */
        .emoji {
            font-size: 1.25rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .home-link {
                position: static;
                display: block;
                margin-bottom: 8px;
            }

            body {
                padding: 8px;
                font-size: 14px;
            }
            
            .container {
                margin: 0;
                border-radius: 0;
                border-left: none;
                border-right: none;
            }
            
            .header {
                padding: 32px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header .subtitle {
                font-size: 1rem;
            }
            
            .content {
                padding: 32px 20px;
            }
            
            h1 {
                font-size: 1.875rem;
            }
            
            h2 {
                font-size: 1.5rem;
                margin-top: 32px;
            }
            
            h3 {
                font-size: 1.25rem;
                margin-top: 24px;
            }
            
            .project-card {
                padding: 20px;
                margin: 20px 0;
            }
            
            .project-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
        /* Navigation */
        .nav {
            margin-bottom: 16px;
        }

        .nav a {
            color: var(--gh-text-secondary);
            font-size: 0.875rem;
            margin: 0 12px;
        }

        .nav a:hover {
            color: var(--gh-accent);
        }

        .home-link {
            position: absolute;
            top: 16px;
            left: 32px;
            font-size: 0.875rem;
            color: var(--gh-text-muted);
        }

        .home-link:hover {
            color: var(--gh-accent);
        }

        
            .footer {
                padding: 24px 20px;
            }
            
            pre {
                font-size: 0.75rem;
                padding: 12px;
            }
            
            ul, ol {
                margin-left: 20px;
            }
            
            .step-box {
                padding: 16px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.75rem;
            }
            
            .content {
                padding: 24px 16px;
            }
            
            .project-card {
                padding: 16px;
            }
            
            h2 {
                font-size: 1.25rem;
            }
            
            h3 {
                font-size: 1.125rem;
            }
        }
        
        /* Focus and Accessibility */
        a:focus,
        button:focus {
            outline: 2px solid var(--gh-accent);
            outline-offset: 2px;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gh-bg);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gh-border);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gh-accent);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-link">‚Üê Home</a>
            <h1>Port Scanner</h1>
            <p class="subtitle">Build a network reconnaissance tool to discover open ports and services</p>
        </div>

        <div class="content">
            <div class="project-header">
                <span class="difficulty"><strong>Difficulty:</strong> ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ</span>
                <span class="time"><strong>Time:</strong> 3-4 hours</span>
                <span class="skills"><strong>Skills:</strong> Network security, socket programming, scanning techniques</span>
            </div>

            <h2>Project Overview</h2>
            <p>In this project, you'll build a port scanner that identifies open ports and running services on target systems. This is a fundamental network reconnaissance tool used in security assessments and network administration.</p>

            <h2>Why This Project Matters</h2>
            <p>Port scanning is essential for network security assessment. According to security reports, misconfigured services and open ports are common attack vectors. By building this tool, you'll learn:</p>
            <ul>
                <li>TCP/IP networking fundamentals</li>
                <li>Socket programming concepts</li>
                <li>Common ports and their associated services</li>
                <li>Network reconnaissance techniques</li>
                <li>Ethical considerations in network scanning</li>
            </ul>

            <h2>What You'll Build</h2>
            <p>A comprehensive port scanning tool that:</p>
            <ul>
                <li>Scans specified port ranges on target hosts</li>
                <li>Identifies open ports and running services</li>
                <li>Provides detailed scan results and reporting</li>
                <li>Includes proper error handling and timeouts</li>
                <li>Supports both single host and IP range scanning</li>
                <li>Implements ethical scanning practices</li>
            </ul>

            <h2>Prerequisites</h2>
            <p>Before starting, make sure you have:</p>
            <ul>
                <li>Python 3.8 or higher installed</li>
                <li>Basic understanding of networking concepts</li>
                <li>A test environment (virtual machines recommended)</li>
                <li>Permission to scan target systems</li>
            </ul>

            <h2>Step-by-Step Implementation</h2>

            <div class="step-box">
                <div class="step-number">1</div>
                <h3>Project Setup and Basic Structure</h3>
                <p>Create the project directory and set up the basic file structure.</p>
                <pre><code># Create project directory
mkdir port-scanner
cd port-scanner

# Create main files
touch port_scanner.py
touch network_utils.py
touch requirements.txt

# Create test script
touch test_scan.py</code></pre>
                <p><strong>Why this structure?</strong> Separating utilities from the main scanner makes the code more modular and easier to maintain.</p>
            </div>

            <div class="step-box">
                <div class="step-number">2</div>
                <h3>Install Required Libraries</h3>
                <p>Set up the dependencies for network operations and IP address handling.</p>
                <pre><code># requirements.txt
socket          # Low-level networking
ipaddress       # IP address manipulation
datetime        # Timestamp handling
argparse        # Command-line argument parsing</code></pre>
                <pre><code>pip install -r requirements.txt</code></pre>
                <p><strong>Library choices:</strong></p>
                <ul>
                    <li><code>socket</code>: Core networking functionality</li>
                    <li><code>ipaddress</code>: Proper IP address validation and manipulation</li>
                    <li><code>datetime</code>: Scan timing and reporting</li>
                    <li><code>argparse</code>: Professional command-line interface</li>
                </ul>
            </div>

            <div class="step-box">
                <div class="step-number">3</div>
                <h3>Create Network Utility Functions</h3>
                <p>Build helper functions for IP address validation, hostname resolution, and port information.</p>
                <pre><code>import socket
import ipaddress
from datetime import datetime

def validate_ip_address(ip_string):
    """
    Validate if string is a valid IP address

    Args:
        ip_string (str): IP address string

    Returns:
        bool: True if valid IP address
    """
    try:
        ipaddress.ip_address(ip_string)
        return True
    except ValueError:
        return False

def resolve_hostname(hostname):
    """
    Resolve hostname to IP address

    Args:
        hostname (str): Hostname to resolve

    Returns:
        str: IP address or None if resolution fails
    """
    try:
        ip_address = socket.gethostbyname(hostname)
        return ip_address
    except socket.gaierror:
        return None

def get_service_name(port, protocol='tcp'):
    """
    Get service name for a port number

    Args:
        port (int): Port number
        protocol (str): Protocol ('tcp' or 'udp')

    Returns:
        str: Service name or 'unknown'
    """
    try:
        service = socket.getservbyport(port, protocol)
        return service
    except OSError:
        return 'unknown'

def expand_port_range(port_range):
    """
    Expand port range string to list of ports

    Args:
        port_range (str): Port range like "80,443" or "1-1024"

    Returns:
        list: List of port numbers
    """
    ports = []

    for part in port_range.split(','):
        part = part.strip()
        if '-' in part:
            start, end = map(int, part.split('-'))
            ports.extend(range(start, end + 1))
        else:
            ports.append(int(part))

    return sorted(list(set(ports)))  # Remove duplicates and sort

def format_scan_time(seconds):
    """
    Format scan duration for display

    Args:
        seconds (float): Duration in seconds

    Returns:
        str: Formatted time string
    """
    if seconds < 1:
        return ".1f"
    elif seconds < 60:
        return ".1f"
    else:
        minutes = int(seconds // 60)
        remaining_seconds = seconds % 60
        return ".1f"</code></pre>
                <p><strong>Utility functions:</strong> These helper functions handle the complex networking details, making the main scanner logic cleaner.</p>
            </div>

            <div class="step-box">
                <div class="step-number">4</div>
                <h3>Implement Core Port Scanning Logic</h3>
                <p>Create the main port scanning functions with proper error handling and timeouts.</p>
                <pre><code>def scan_single_port(host, port, timeout=1):
    """
    Scan a single port on a target host

    Args:
        host (str): Target host IP or hostname
        port (int): Port number to scan
        timeout (float): Connection timeout in seconds

    Returns:
        dict: Scan result with port status and service info
    """
    result = {
        'port': port,
        'status': 'closed',
        'service': 'unknown',
        'error': None
    }

    try:
        # Create socket
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(timeout)

        # Attempt connection
        connection_result = sock.connect_ex((host, port))

        if connection_result == 0:
            result['status'] = 'open'
            result['service'] = get_service_name(port)
        else:
            result['status'] = 'closed'

        sock.close()

    except socket.timeout:
        result['status'] = 'filtered'
        result['error'] = 'timeout'
    except socket.error as e:
        result['status'] = 'error'
        result['error'] = str(e)
    except Exception as e:
        result['status'] = 'error'
        result['error'] = f"unexpected error: {e}"

    return result

def scan_ports(host, ports, timeout=1, verbose=False):
    """
    Scan multiple ports on a target host

    Args:
        host (str): Target host
        ports (list): List of port numbers to scan
        timeout (float): Connection timeout
        verbose (bool): Enable verbose output

    Returns:
        dict: Scan results
    """
    results = {
        'host': host,
        'scan_time': datetime.now().isoformat(),
        'total_ports': len(ports),
        'open_ports': [],
        'closed_ports': [],
        'filtered_ports': [],
        'errors': []
    }

    print(f"Scanning {host} for {len(ports)} ports...")

    for i, port in enumerate(ports):
        if verbose and (i + 1) % 10 == 0:
            print(f"Scanned {i + 1}/{len(ports)} ports...")

        result = scan_single_port(host, port, timeout)

        if result['status'] == 'open':
            results['open_ports'].append(result)
            if verbose:
                print(f"Port {port}/tcp: OPEN ({result['service']})")
        elif result['status'] == 'closed':
            results['closed_ports'].append(result)
        elif result['status'] == 'filtered':
            results['filtered_ports'].append(result)
        else:
            results['errors'].append(result)

    return results</code></pre>
                <p><strong>Scan logic:</strong> The scanner handles different port states (open, closed, filtered) and provides detailed results for analysis.</p>
            </div>

            <div class="step-box">
                <div class="step-number">5</div>
                <h3>Add Host Discovery and Validation</h3>
                <p>Implement host validation and network range scanning capabilities.</p>
                <pre><code>def validate_target(target):
    """
    Validate and resolve target host

    Args:
        target (str): Hostname or IP address

    Returns:
        str: Resolved IP address or None
    """
    # Check if it's already a valid IP
    if validate_ip_address(target):
        return target

    # Try to resolve hostname
    resolved_ip = resolve_hostname(target)
    if resolved_ip:
        print(f"Resolved {target} to {resolved_ip}")
        return resolved_ip

    print(f"Could not resolve host: {target}")
    return None

def scan_network_range(network_range, ports, timeout=1):
    """
    Scan a range of IP addresses

    Args:
        network_range (str): Network range like "192.168.1.0/24"
        ports (list): Ports to scan
        timeout (float): Connection timeout

    Returns:
        dict: Results for all hosts in range
    """
    try:
        network = ipaddress.ip_network(network_range, strict=False)
    except ValueError as e:
        print(f"Invalid network range: {e}")
        return {}

    results = {}
    total_hosts = network.num_addresses

    print(f"Scanning network {network_range} ({total_hosts} hosts)...")

    for i, host_ip in enumerate(network.hosts()):
        if (i + 1) % 10 == 0:
            print(f"Scanned {i + 1}/{total_hosts} hosts...")

        host_results = scan_ports(str(host_ip), ports, timeout, verbose=False)
        if host_results['open_ports']:
            results[str(host_ip)] = host_results
            print(f"Host {host_ip}: {len(host_results['open_ports'])} open ports")

    return results

def is_host_reachable(host, timeout=1):
    """
    Quick check if host is reachable

    Args:
        host (str): Target host

    Returns:
        bool: True if host responds to ping-like check
    """
    try:
        # Try to connect to a common port (80) to check reachability
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(timeout)
        result = sock.connect_ex((host, 80))
        sock.close()
        return result == 0
    except:
        return False</code></pre>
                <p><strong>Network scanning:</strong> These functions enable scanning entire network ranges, which is useful for network inventory and security assessments.</p>
            </div>

            <div class="step-box">
                <div class="step-number">6</div>
                <h3>Create the Command-Line Interface</h3>
                <p>Build a professional command-line interface with comprehensive options.</p>
                <pre><code>#!/usr/bin/env python3
"""
Port Scanner - Network reconnaissance tool
A comprehensive port scanning utility for security assessments
"""

import argparse
import sys
from datetime import datetime

# Import our modules
from network_utils import (
    validate_target, expand_port_range, format_scan_time
)
from port_scanner import scan_ports, scan_network_range

def print_scan_results(results):
    """Display scan results in a formatted way"""
    print("\n" + "="*60)
    print("PORT SCAN RESULTS")
    print("="*60)
    print(f"Target: {results['host']}")
    print(f"Scan Time: {results['scan_time']}")
    print(f"Total Ports Scanned: {results['total_ports']}")
    print()

    if results['open_ports']:
        print(f"OPEN PORTS ({len(results['open_ports'])}):")
        print("-" * 40)
        for port_info in results['open_ports']:
            service = port_info['service']
            print("6d")
        print()
    else:
        print("No open ports found.")
        print()

    if results['filtered_ports']:
        print(f"FILTERED PORTS ({len(results['filtered_ports'])}):")
        print("-" * 40)
        for port_info in results['filtered_ports']:
            print("6d")
        print()

    if results['errors']:
        print(f"ERRORS ({len(results['errors'])}):")
        print("-" * 40)
        for error_info in results['errors']:
            print("6d")

    print("="*60)

def main():
    parser = argparse.ArgumentParser(
        description="Port Scanner - Network reconnaissance tool",
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
Examples:
  # Scan common ports on a single host
  python port_scanner.py example.com -p 80,443,22

  # Scan port range
  python port_scanner.py 192.168.1.1 -p 1-1024

  # Network scan with verbose output
  python port_scanner.py 192.168.1.0/24 -p 80,443 -v

  # Quick scan of top 100 ports
  python port_scanner.py example.com --top-ports 100
        """
    )

    parser.add_argument('target', help='Target host, IP address, or network range')
    parser.add_argument('-p', '--ports', default='1-1024',
                       help='Port range to scan (default: 1-1024)')
    parser.add_argument('-t', '--timeout', type=float, default=1.0,
                       help='Connection timeout in seconds (default: 1.0)')
    parser.add_argument('-v', '--verbose', action='store_true',
                       help='Enable verbose output')
    parser.add_argument('--top-ports', type=int,
                       help='Scan top N most common ports')
    parser.add_argument('--network-scan', action='store_true',
                       help='Treat target as network range (CIDR notation)')

    args = parser.parse_args()

    # Validate target
    if args.network_scan:
        # Network range scanning
        try:
            import ipaddress
            network = ipaddress.ip_network(args.target, strict=False)
            print(f"Network scan mode: {args.target}")
        except ValueError:
            print(f"Invalid network range: {args.target}")
            sys.exit(1)
    else:
        # Single host scanning
        target_ip = validate_target(args.target)
        if not target_ip:
            print(f"Could not resolve target: {args.target}")
            sys.exit(1)
        print(f"Target resolved to: {target_ip}")

    # Parse ports
    if args.top_ports:
        # Use most common ports
        common_ports = [
            21, 22, 23, 25, 53, 80, 110, 111, 135, 139, 143, 443, 445,
            993, 995, 1723, 3306, 3389, 5900, 8080
        ]
        ports_to_scan = common_ports[:args.top_ports]
        print(f"Scanning top {len(ports_to_scan)} ports")
    else:
        try:
            ports_to_scan = expand_port_range(args.ports)
            print(f"Scanning ports: {args.ports} ({len(ports_to_scan)} ports)")
        except ValueError as e:
            print(f"Invalid port range: {e}")
            sys.exit(1)

    # Start scan
    start_time = datetime.now()

    try:
        if args.network_scan:
            # Network range scan
            results = scan_network_range(args.target, ports_to_scan, args.timeout)

            if results:
                print(f"\nFound {len(results)} hosts with open ports:")
                for host, host_results in results.items():
                    print(f"\nHost: {host}")
                    print_scan_results(host_results)
            else:
                print("\nNo hosts with open ports found in the specified range.")
        else:
            # Single host scan
            results = scan_ports(target_ip, ports_to_scan, args.timeout, args.verbose)
            print_scan_results(results)

    except KeyboardInterrupt:
        print("\nScan interrupted by user.")
        sys.exit(1)
    except Exception as e:
        print(f"Scan failed: {e}")
        sys.exit(1)

    # Print timing
    end_time = datetime.now()
    duration = (end_time - start_time).total_seconds()
    print(f"\nScan completed in {format_scan_time(duration)}")

if __name__ == "__main__":
    main()</code></pre>
                <p><strong>CLI design:</strong> A comprehensive command-line interface with multiple options makes the tool flexible and professional.</p>
            </div>

            <div class="step-box">
                <div class="step-number">7</div>
                <h3>Test Your Port Scanner</h3>
                <p>Test the scanner with various targets and configurations.</p>
                <pre><code># Test with localhost (safe)
python port_scanner.py localhost -p 80,443,22

# Test with common ports
python port_scanner.py example.com --top-ports 20

# Test port range
python port_scanner.py scanme.nmap.org -p 1-100 -v

# Test network range (use your local network)
python port_scanner.py 192.168.1.0/24 -p 80,443 --network-scan</code></pre>
                <p><strong>Testing considerations:</strong> Always test on systems you own or have permission to scan. Use services like scanme.nmap.org for safe testing.</p>
            </div>

            <h2>Enhancement Ideas</h2>
            <div class="tips-box">
                <h3>Advanced Features to Add</h3>
                <ul>
                    <li><strong>Service Version Detection:</strong> Identify exact service versions running on ports</li>
                    <li><strong>OS Fingerprinting:</strong> Attempt to identify the target operating system</li>
                    <li><strong>UDP Scanning:</strong> Add support for UDP port scanning</li>
                    <li><strong>Stealth Scanning:</strong> Implement SYN scanning and other stealth techniques</li>
                    <li><strong>Multi-threading:</strong> Speed up scans with concurrent port checking</li>
                    <li><strong>Output Formats:</strong> Support XML, JSON, and CSV output formats</li>
                    <li><strong>Timing Controls:</strong> Add delays between scans to avoid detection</li>
                </ul>
            </div>

            <h2>Common Mistakes to Avoid</h2>
            <div class="pitfalls-box">
                <p><span class="wrong">‚ùå Scanning without permission</span><br>
                <span class="right">‚úÖ Always get written authorization before scanning</span></p>
                <p><span class="wrong">‚ùå Using default timeouts that are too short</span><br>
                <span class="right">‚úÖ Adjust timeouts based on network conditions</span></p>
                <p><span class="wrong">‚ùå Not handling network errors gracefully</span><br>
                <span class="right">‚úÖ Implement proper error handling for all network operations</span></p>
                <p><span class="wrong">‚ùå Scanning all ports unnecessarily</span><br>
                <span class="right">‚úÖ Use targeted port lists for efficiency</span></p>
                <p><span class="wrong">‚ùå Not documenting scan activities</span><br>
                <span class="right">‚úÖ Keep detailed logs of all scanning activities</span></p>
            </div>

            <h2>Resources & Further Reading</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <h4>Official Documentation</h4>
                    <ul>
                        <li><a href="https://docs.python.org/3/library/socket.html" class="resource-link">Python socket documentation</a></li>
                        <li><a href="https://docs.python.org/3/library/ipaddress.html" class="resource-link">Python ipaddress module</a></li>
                        <li><a href="https://nmap.org/book/man-port-scanning-techniques.html" class="resource-link">Nmap port scanning techniques</a></li>
                    </ul>
                </div>
                <div class="resource-card">
                    <h4>Security Research</h4>
                    <ul>
                        <li><a href="https://en.wikipedia.org/wiki/Port_scanner" class="resource-link">Port Scanning Overview</a></li>
                        <li><a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml" class="resource-link">IANA Port Assignments</a></li>
                        <li><a href="https://tools.ietf.org/html/rfc793" class="resource-link">TCP Protocol Specification</a></li>
                    </ul>
                </div>
                <div class="resource-card">
                    <h4>Learning Resources</h4>
                    <ul>
                        <li><a href="https://tryhackme.com/room/networkservices" class="resource-link">TryHackMe: Network Services</a></li>
                        <li><a href="https://www.coursera.org/learn/tcp-ip-protocol" class="resource-link">Coursera: TCP/IP Protocols</a></li>
                        <li><a href="https://www.youtube.com/watch?v=3fPjUjqVjtc" class="resource-link">Port Scanning Explained</a></li>
                    </ul>
                </div>
            </div>

            <h2>Security Best Practices</h2>
            <div class="security-note">
                <strong>üîí Port Scanning Ethics and Legality:</strong>
                <ul>
                    <li>Only scan systems you own or have explicit written permission to test</li>
                    <li>Unauthorized port scanning may violate laws like the Computer Fraud and Abuse Act</li>
                    <li>Use scanning tools responsibly and for defensive security purposes</li>
                    <li>Respect network usage policies and avoid disrupting services</li>
                    <li>Document all scanning activities with timestamps and justifications</li>
                    <li>Be aware that scanning can trigger security alerts and monitoring systems</li>
                    <li>Use appropriate timing controls to avoid being mistaken for a denial-of-service attack</li>
                </ul>
            </div>

            <h2>What You Learned</h2>
            <div class="takeaways">
                <h3>Key Takeaways</h3>
                <ul>
                    <li>Port scanning reveals network service exposure and potential vulnerabilities</li>
                    <li>TCP/IP socket programming enables low-level network interaction</li>
                    <li>Proper error handling is essential for reliable network tools</li>
                    <li>Network reconnaissance requires careful ethical consideration</li>
                    <li>Command-line tools should provide clear, actionable output</li>
                </ul>
            </div>

            <h2>Next Steps</h2>
            <div class="next-steps">
                <h3>Continue Your Learning Journey</h3>
                <ol>
                    <li>Implement service version detection using banner grabbing</li>
                    <li>Add multi-threading for faster scanning</li>
                    <li>Study Nmap's advanced scanning techniques</li>
                    <li>Explore passive reconnaissance methods</li>
                    <li>Learn about intrusion detection system evasion</li>
                </ol>
            </div>

            <div class="next-steps">
                <h3>Related Projects to Try Next</h3>
                <ol>
                    <li><a href="network-packet-sniffer.html" class="resource-link">Network Packet Sniffer</a> - Analyze network traffic in detail</li>
                    <li><a href="firewall-rule-generator.html" class="resource-link">Firewall Rule Generator</a> - Create rules based on scan results</li>
                    <li><a href="web-vulnerability-scanner.html" class="resource-link">Web Vulnerability Scanner</a> - Focus on web application security</li>
                </ol>
            </div>
        </div>

        <div class="footer">
            <div class="nav">
                <a href="index.html">Home</a> |
                <a href="fundamentals.html">Fundamentals</a> |
                <a href="network-security.html">Network Security</a> |
                <a href="web-security.html">Web Security</a> |
                <a href="advanced-projects.html">Advanced Projects</a> |
                <a href="cybersecurity-projects-for-beginners.html">All Projects</a>
            </div>
            <p><em>Happy coding! Network reconnaissance is the foundation of security assessment.</em> <span class="emoji">üîç</span></p>
            <p><strong>Project:</strong> Port Scanner | <strong>Difficulty:</strong> Beginner</p>
            <p><strong>Author:</strong> jaspreet_singh | <strong>¬©</strong> 2025</p>
            <div class="tags">
                <span class="tag">#Cybersecurity</span>
                <span class="tag">#NetworkSecurity</span>
                <span class="tag">#PortScanning</span>
                <span class="tag">#Python</span>
            </div>
        </div>
    </div>
</body>
</html>